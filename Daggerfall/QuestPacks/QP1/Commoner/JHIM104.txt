Quest: JHIM104
DisplayName: Бесконечный сезон
-- Message panels
QRC:

QuestorOffer:  [1000]
<ce> Привет! Здравствуйте! Прекрасный день для знакомства с Вами.
<ce> Я пришел за долгосрочной помощью
<ce> на нашей семейной ферме. Мы заплатим вам деньги
<ce> за это, клянусь!

RefuseQuest:  [1001]
<ce> Ах, как же мне везет.

AcceptQuest:  [1002]
<ce> Замечательно! Потрясающе! Большое спасибо!
<ce> %hnr, если вы отправитесь на ___farm_
<ce> в течение =timer_ дней
<ce> они будут очень рады Вас видеть.
<ce> Может быть, мы там встретимся
<ce> тоже! Счастливого пути Вам!

QuestFail:  [1003]
<ce> Вы отказались посетить ___farm_ в течение
<ce> указанного срока.

QuestComplete:  [1004]
<ce> Вы подходите к дому и с удивлением
<ce> услышав радостные возгласы и пение.
<ce> _farmer_ и его семья ждут вас
<ce> с лучезарными улыбками и завернутым пакетом.
<ce>
<ce> "Мы просто хотели выразить вам свою признательность
<ce> за помощь, которую вы оказали нам в прошлом году.
<ce> Мы очень благодарны Вам за то, что Вы помогли нам
<ce> из некоторых затруднительных ситуаций.
<ce> Вот! Возьмите!"
<ce>
<ce> Скоро им придется вернуться к своим обязанностям,
<ce> но они с радостными глазами ждут, когда вы откроете
<ce> подарочную упаковку.

Message:  1010
%qdt:
 Я предложил немного своего времени
 для помощи в устранении проблем на
 ферме под названием ___farm_
 в ____farm_. Меня попросили
 прибыть в течение =timer_ дней.

Message:  1011
<ce> "Ну разве это не победа! Небольшая просьба о помощи,
<ce> и это действительно сработало! Большое спасибо %hnr.
<ce> Меня зовут _farmer_, я глава этого дома.
<ce> Скажу честно, нам пока нечем заняться, но
<ce> но мы пришлем вам сообщение, когда появится что-то действительно плохое.
<ce> И да, оплата будет! Клянусь могилой моего деда,
<ce> мы заплатим вам за вашу помощь!"
<ce>
<ce> После этого фермер возвращается к работе.

Message:  1012
<ce> "Эй ты! %hnr! %ра!"
<ce>
<ce> Вы оборачиваетесь и видите, что вас зовет более бедный юноша,
<ce> дрожащего на зимнем воздухе.
<ce>
<ce> "Если вы можете вернуться на ___farm_, у нас есть
<ce> проблема, которую, мы надеемся, ты сможешь решить!
<ce> Приходите и найдите моего отца в доме!"
<ce>
<ce> Затем юноша отправляется домой к %di.

Message:  1013
%qdt:
 Меня вызвали на ___farm_.
 чтобы помочь им в чем-то.
 Я должен пойти в резиденцию
 чтобы узнать, чем я могу помочь.

Message:  1014
<ce> Вы входите в дом, и _farmer_ радостно кричит.
<ce>
<ce> "Рад, что наш наемный помощник здесь! У нас действительно были проблемы.
<ce> У нас возникли проблемы с нашим основным поставщиком,
<ce> магазином под названием _shop_ в ___shop_.
<ce> Уже несколько недель от них нет ни слова.
<ce> Нам нужна новая партия товара, но мы понятия не имеем.
<ce> в чем причина задержки. Мне нужно навестить это место, так что
<ce> не могли бы вы съездить за меня? Просто спроси их, в чем дело,
<ce> для этого не нужно никакого специального разрешения.
<ce> Увидимся здесь, когда все закончится.
<ce> Спасибо, %hnr".

Message:  1015
%qdt:
 _farmer_ из ___farm_
 попросил меня посетить _shop_
 в ___shop_ и спросить у поставщика
 почему в последнее время они не получали никаких поставок.

Message:  1016
<ce> Да, здравствуйте? ___farm_?
<ce> О, боже. Это имя кажется знакомым, но... позвольте мне проверить.
<ce>
<ce> %oth. Боже мой, мы совсем забыли об этом.
<ce> Он должен был прийти 9-го числа... %oth.
<ce> Я рад, что вы пришли нас проведать! Да, пожалуйста.
<ce> передайте _farmer_ , что это наша первоочередная задача.
<ce> Мы не ляжем спать сегодня, пока
<ce> пока не загрузим повозку. Приношу свои искренние извинения!

Message:  1017
<ce> Рядом находится _farmer_. Он внимательно слушает.
<ce>
<ce> "Ха! Простая ошибка, я так и знал! Хорошо, что
<ce> что мы пресекли эту маленькую проблему в зародыше.
<ce> Спасибо тебе, %pcf. Возьми себе немного
<ce> золота на дорогу".
<ce>
<ce> Он отсчитывает =winterreward_ золотых.

Message:  1018
<ce> "Эй ты! %hnr! %ra!"
<ce>
<ce> Вы оборачиваетесь и видите, как более бедный юноша зовет вас
<ce> в свежем весеннем воздухе.
<ce>
<ce> "Если вы можете вернуться на ___farm_, у нас есть
<ce> проблема, которую, мы надеемся, ты сможешь решить!
<ce> Приходите и ищите моего отца в доме!"
<ce>
<ce> Затем юноша отправляется домой к %di.

Message:  1019
<ce> Вы находите неподалеку _farmer_, который держит в руках тупой нож.
<ce>
<ce> "Привет, %pcf! Рад тебя видеть. У нас проблема с летучими мышами.
<ce> Мерзкие твари выходят из спячки
<ce> и ищут еду везде, где только могут найти.
<ce> Каждые несколько часов появляется еще одна.
<ce> Не могли бы вы провести здесь несколько дней и
<ce> и уничтожить их? Это сводит нас всех с ума, - говорю я.
<ce> Я раздобуду плату, когда буду уверен, что они все мертвы".
<ce>
<ce> Затем он берет столь необходимый отдых, передавая
<ce> проблему летучих мышей на вас.

Message:  1020
<ce> К Вам с улыбкой подходит _farmer_.
<ce>
<ce> "Уже несколько часов не слышно чириканья!
<ce> Думаю, у нас с ними все в порядке. Ты
<ce> огромную помощь в этом кошмаре.
<ce> Я надеюсь, что эти =springreward_ золотых покажут нашу искреннюю
<ce> благодарность Вам".

Message:  1021
<ce> "Эй ты! %hnr! %ra!"
<ce>
<ce> Вы оборачиваетесь и видите, как более бедный юноша зовет вас
<ce> в теплом летнем воздухе.
<ce>
<ce> "Если вы можете вернуться на ___farm_, у нас есть
<ce> проблема, которую, мы надеемся, ты сможешь решить!
<ce> Приходите и ищите моего отца в доме!"
<ce>
<ce> Затем юноша отправляется домой к %di.

Message:  1022
<ce> Вы входите в дом и обнаруживаете _farmer_, ожидающего вас.
<ce>
<ce> "А, рад вас видеть! Готовы к путешествию?
<ce> Надеюсь, прогулка сюда не утомила вас.
<ce> Каждый год я совершаю путешествие, чтобы навестить свою умершую
<ce> семью в ___cemetery_, которая находится в %di
<ce> отсюда. Обычно я провожу там несколько часов
<ce> а потом возвращаюсь. Я бы предпочел поехать с
<ce> группой, но никто не принял мое предложение.
<ce> Тогда я пойду с вами! Мы можем отправиться на
<ce> кладбище, когда вы будете готовы".

Message:  1023
<ce> _farmer_ затихает, когда вы входите на кладбище.
<ce> Он идет ухаживать за надгробиями, удаляя сорняки, выдергивая лианы и выбрасывая обломки.
<ce> удаляет сорняки, выдирает лианы, выбрасывает обломки.
<ce> Процесс занимает некоторое время, перемежаясь с
<ce> тихими размышлениями и воспоминаниями.
<ce> Вы терпеливо ждете, и он возвращается к вам.
<ce>
<ce> "Спасибо, %pcf. Это очень много для меня значит.
<ce> Мне жаль, что у меня нет больше денег, чтобы заплатить вам,
<ce> но в последние месяцы урожай был скудным.
<ce> Пожалуйста, возьмите эти =summerreward_ золотых.
<ce> Я сам могу найти дорогу домой. Я знаю дорогу,
<ce> и я уже отнял у тебя достаточно времени. Прощайте."

Message:  1024
<ce> "Эй ты! %hnr! %ra!"
<ce>
<ce> Вы оборачиваетесь и видите, как более бедный юноша зовет вас
<ce> в прохладном осеннем воздухе.
<ce>
<ce> "Если вы можете вернуться на ___farm_, у нас есть
<ce> проблема, которую, мы надеемся, ты сможешь решить!
<ce> Приходите и ищите моего отца в доме!"
<ce>
<ce> Затем юноша отправляется домой к %di.

Message:  1025
<ce> _farmer_ ждет у двери и выглядит испуганным.
<ce>
<ce> "О! %pcf! Как я рад, что ты здесь, у нас проблема!
<ce> Какой-то глупый медведь постоянно заходит на наш участок, ища
<ce> в поисках чего-нибудь съестного перед спячкой.
<ce> Мы боимся, что он нападет на кого-нибудь из нас.
<ce> Пожалуйста, выйдите на улицу и помогите мне выманить его.
<ce> Животное должно умереть, иначе это будет один из нас.
<ce> Быстрее! Я вижу, что оно приближается!"
<ce>
<ce> _farmer_ начинает визжать и кричать,
<ce> вглядываясь вдаль. Его глаза расширяются.
<ce>
<ce> "Вот он! Я вижу, как он надвигается оттуда!
<ce> Все в твоих руках %pcf!"
<ce>
<ce> Затем он ныряет обратно в дом, когда
<ce> медведь бежит к вам.

Message:  1027
<ce> Выходит _farmer_ и подходит к вам,
<ce> очень радуясь, что вы выжили.
<ce>
<ce> "Мне очень жаль, это была такая глупая идея!
<ce> Но вы прекрасно справились с собой.
<ce> Большое спасибо, что позаботились об этом.
<ce> Вот все монеты, которые я могу выделить за этот месяц.
<ce> Пожалуйста, возьмите их". Он отсчитывает =fallreward_ золотых
<ce> и снова направляется в дом.

Message:  1028
%qdt:
 Мы с _farmer_ направляемся в
 ___cemetery_ , чтобы почтить память его умерших.

Message:  1029
<ce> "Эй ты! %hnr! %ra!"
<ce>
<ce> Вы оборачиваетесь и видите, что вас зовет хорошо одетый молодой человек.
<ce>
<ce> "Если вы можете вернуться на ___farm_,
<ce> у нас есть кое-что, что мы хотим вам показать!!!"
<ce>
<ce> Затем юноша отправляется домой к %di.

Message:  1030
%qdt:
 _farmer_ попросил меня пойти
 на ___farm_ снова, чтобы показать мне кое-что.

Message:  1031
<ce> Как только вы ступаете на территорию, приветливый человек
<ce> машет вам рукой и спрашивает, как вы узнали это место.
<ce> Вы отвечаете, что вас послал _qgiver_ из ___qgiver_.

Message:  1032
%qdt:
 Я предложил немного своего времени
 для помощи в устранении проблем на
 ферме под названием ___farm_
 в ____farm_.
 Они дадут мне знать, когда я буду нужен.

QBN:

Place _farm_ remote farmhome

Person _qgiver_ group Questor
Person _farmer_ faction The_Merchants male remote
Person _shopkeep_ faction The_Merchants remote

Place _shop_ remote generalstore
Place _cemetery_ remote graveyard

Foe _bat_ is Giant_bat
Foe _bear_ is Grizzley_bear

Clock _delay_ 3.00:00 5.00:00
Clock _batdelay_ 6:00
Clock _timer_ 00:00 0 flag 17 range 0 2
Clock _finaldelay_ 2.00:00 3.00:00

Item _winterletter_ letter
Item _springletter_ letter
Item _summerletter_ letter
Item _fallletter_ letter
Item _winterreward_ gold range 100 to 200
Item _springreward_ gold range 150 to 200
Item _summerreward_ gold range 100 to 150
Item _fallreward_ gold range 150 to 250
Item _finalreward_ magic_item
Item _endingletter_ letter

--	Quest start-up:
    start timer _timer_
    log 1010 step 0
    pc at _farm_ do _inside_
    have _winterletter_ set _beginwinter2_
    have _springletter_ set _beginspring2_
    have _summerletter_ set _beginsummer2_
    have _fallletter_ set _beginfall2_

_inside_ task:
    start task _greeting_

_greeting_ task:
    say 1031
    say 1011
    start timer _delay_
    stop timer _timer_
    log 1032 step 0

_timer_ task:
    say 1003
    end quest

variable _delay_
variable _eventlock_
_winter_ task:
    season winter

_spring_ task:
    season spring

_summer_ task:
    season summer

_fall_ task:
    season fall

_beginwinter_ task:
    when _delay_ and _winter_ and not _eventlock_ and not _winterfinished_
    give pc _winterletter_ notify 1012

_beginwinter2_ task:
    take _winterletter_ from pc
    log 1013 step 0
    start task _eventlock_
    start task _beginwinter3_

variable _beginwinter3_
_beginwinter4_ task:
    when _inside_ and _beginwinter3_ and not _winterfinished_
    say 1014
    log 1015 step 0
    place npc _shopkeep_ at _shop_

_clickshopkeep_ task:
    clicked npc _shopkeep_

_nullifyshopkeep_ task:
    when _clickshopkeep_ and not _beginwinter3_ and not _winterfinished_
    clear _nullifyshopkeep_ _clickshopkeep_

_advanceshopkeep_ task:
    when _clickshopkeep_ and _beginwinter3_ and not _winterfinished_
    say 1016

_endwinterevent_ task:
    when _advanceshopkeep_ and _inside_ and not _winterfinished_
    say 1017
    get item _winterreward_
    clear _eventlock_
    remove log step 0
    start task _winterfinished_

variable _winterfinished_
_beginspring_ task:
    when _delay_ and _spring_ and not _eventlock_ and not _springfinished_
    give pc _springletter_ notify 1018

_beginspring2_ task:
    take _springletter_ from pc
    log 1013 step 0
    start task _eventlock_
    start task _beginspring3_

variable _beginspring3_
_beginspring4_ task:
    when _inside_ and _beginspring3_ and not _batslain_ and not _springfinished_
    say 1019
    create foe _bat_ every 135 minutes indefinitely with 95% success

_batslain_ task:
    killed 5 _bat_
    start timer _batdelay_

variable _batdelay_
_endspringevent_ task:
    when _batdelay_ and _inside_ and not _springfinished_
    say 1020
    get item _springreward_
    clear _eventlock_
    remove log step 0
    start task _springfinished_

variable _springfinished_
_beginsummer_ task:
    when _delay_ and _summer_ and not _eventlock_ and not _summerfinished_
    give pc _summerletter_ notify 1021

_beginsummer2_ task:
    take _summerletter_ from pc
    log 1013 step 0
    start task _eventlock_
    start task _beginsummer3_

variable _beginsummer3_
_beginsummer4_ task:
    when _beginsummer3_ and _inside_ and not _summerfinished_
    say 1022
    add _farmer_ face
    start task _walking_
    log 1028 step 0
    reveal _cemetery_

_walking_ task:
    pc at _cemetery_ do _arrivecemetery_

variable _arrivecemetery_
_endsummerevent_ task:
    when _arrivecemetery_ and not _summerfinished_
    say 1023
    get item _summerreward_
    start task _summerfinished_
    remove log step 0
    drop _farmer_ face
    clear _eventlock_

variable _summerfinished_
_beginfall_ task:
    when _delay_ and _fall_ and not _eventlock_ and not _fallfinished_
    give pc _fallletter_ notify 1024

_beginfall2_ task:
    take _fallletter_ from pc
    log 1013 step 0
    start task _eventlock_
    start task _beginfall3_

variable _beginfall3_
_beginfall4_ task:
    when _beginfall3_ and _inside_ and not _fallfinished_
    say 1025
    create foe _bear_ every 0 minutes 1 times with 100% success
    change foe _bear_ infighting true

_endfallevent_ task:
    killed _bear_
    say 1027
    get item _fallreward_
    remove log step 0
    start task _fallfinished_
    clear _eventlock_

variable _fallfinished_

_finalevent_ task:
    when _fallfinished_ and _winterfinished_ and _summerfinished_ and _springfinished_
    start timer _finaldelay_

_finaldelay_ task:
    give pc _endingletter_ notify 1029
    pc at _farm_ do _ending_
    have _endingletter_ set _finaljournal_

_finaljournal_ task:
    log 1030 step 0
    take _endingletter_ from pc

_ending_ task:
    when _finaljournal_ and _inside_
    give pc _finalreward_
    end quest