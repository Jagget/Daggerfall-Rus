Quest: RLQlibrarydonation
DisplayName: СМК: Библиотечные взносы
-- Message panels
QRC:

QuestComplete:   [1004]
<ce> Войдя в библиотеку, вы предъявляете
<ce> выданный вам ваучер, и вам вручают
<ce> идеально чистую новую книгу.

QuestLogEntry:  [1010]
%qdt:
 За небольшое пожертвование мне выдали ваучер
 на бесплатную книгу при следующем посещении
 библиотеки в ____store_.

Message:  1011
<ce> К вам подходит городской чиновник в официальной одежде
<ce> с мешочком для монет и баночкой разноцветных бусин.
<ce>
<ce> "Добрый день, %ra, у меня для вас есть предложение
<ce> и возможность. Я собраю пожертвования на поддержку
<ce> библиотек региона %crn. 35 золотых очистят вашу совесть
<ce> и сохранят их двери открытыми, вот и все. Кроме того,
<ce> вы сможете выбрать одну бусину из этой банки. Если
<ce> бусинка окажется зеленой, то в следующий раз, когда
<ce> вы посетите библиотеку, вы получите книгу в подарок.
<ce> Здорово, не правда ли?"
<ce>
<ce> Вы жертвуете 35 золотых?

Message:  1012
<ce> "Нет, я понимаю. Бедность рано или поздно
<ce> настигает всех нас".
<ce>
<ce> Чиновник продолжает сбор пожертвований.
<--->
<ce> "Вы уверены? Нам всем когда-нибудь понадобится библиотека".
<ce>
<ce> Чиновник продолжает сбор пожертвований.
<--->
<ce> "Ну, я полагаю, не у всех есть склонность
<ce> к чтению и библиотекам".
<ce>
<ce> Чиновник продолжает сбор пожертвований.

Message:  1013
<ce> Вы предлагаете 35 золотых, и чиновник
<ce> с радостью их принимает.
<ce>
<ce> "А теперь, выбирайте бусину!
<ce> Желаю вам удачи!"
<ce>
<ce> Вы протягиваете руку и достаете блестящую
<ce> красную бусину. Он разочарованно вздыхает,
<ce> но благодарит вас за пожертвование
<ce> и обращается к другим людям.
<--->
<ce> Вы предлагаете 35 золотых, и чиновник
<ce> с радостью их принимает.
<ce>
<ce> "А теперь, выбирайте бусину!
<ce> Желаю вам удачи!"
<ce>
<ce> Вы протягиваете руку и достаете блестящую
<ce> черную бусину. Он разочарованно вздыхает,
<ce> но благодарит вас за пожертвование
<ce> и обращается к другим людям.
<--->
<ce> Вы предлагаете 35 золотых, и чиновник
<ce> с радостью их принимает.
<ce>
<ce> "А теперь, выбирайте бусину!
<ce> Желаю вам удачи!"
<ce>
<ce> Вы протягиваете руку и достаете блестящую
<ce> оранжевую бусину. Он разочарованно вздыхает,
<ce> но благодарит вас за пожертвование
<ce> и обращается к другим людям.
<--->
<ce> Вы предлагаете 35 золотых, и чиновник
<ce> с радостью их принимает.
<ce>
<ce> "А теперь, выбирайте бусину!
<ce> Желаю вам удачи!"
<ce>
<ce> Вы протягиваете руку и достаете блестящую
<ce> белую бусину. Он разочарованно вздыхает,
<ce> но благодарит вас за пожертвование
<ce> и обращается к другим людям.
<--->
<ce> Вы предлагаете 35 золотых, и чиновник
<ce> с радостью их принимает.
<ce>
<ce> "А теперь, выбирайте бусину!
<ce> Желаю вам удачи!"
<ce>
<ce> Вы протягиваете руку и достаете блестящую
<ce> голубую бусину. Он разочарованно вздыхает,
<ce> но благодарит вас за пожертвование
<ce> и обращается к другим людям.

Message:  1014
<ce> Вы роетесь в карманах и в сумке, но не
<ce> находите 35 золотых. Чиновник вежливо
<ce> благодарит вас за намерение
<ce> и обращается к другим людям.

Message:  1015
<ce> Вы предлагаете 35 золотых, и чиновник
<ce> с радостью их принимает.
<ce>
<ce> "А теперь, выбирайте бусину!
<ce> Желаю вам удачи!"
<ce>
<ce> Вы протягиваете руку и достаете блестящую
<ce> зеленую бусину. Он радостно кричит.
<ce>
<ce> "Победитель! У нас есть победитель!
<ce> Поздравляю, мой друг! Вот ваучер на
<ce> бесплатную книгу, которую вы получите,
<ce> когда вы в следующий раз посетите любую
<ce> библиотеку в регионе ____store_.
<ce> Большое спасибо, и хорошего дня!"
<ce>
<ce> Затем он переходит к другим горожанам.
<ce> Ваучер настолько мал, что вам не нужно
<ce> выделять для него место среди своих вещей.

QBN:

Place _store_ remote library

Clock _timer_ 30.00:00

Item _reward_ book

--	Quest start-up:
    prompt 1011 yes _pay_ no _reject_
    pc at any library set _entlibr_

_reject_ task:
    say 1012
    end quest

variable _pay_

_payhim_ task:
    when _pay_ and not _given_
    pay 35 money do _given_ otherwise do _nomoney_

_nomoney_ task:
    say 1014
    end quest

_lucky_ task:
    when attribute Luck is at least 90

variable _given_
_unluckypick_ task:
    when _given_ and not _lucky_
    pick one of _failure_ _failure_ _failure_ _success_ _failure_ _failure_ _failure_ _failure_

_luckypick_ task:
    when _given_ and _lucky_
    pick one of _success_ _success_ _failure_

_success_ task:
    say 1015
    log 1010 step 0
    start timer _timer_

_failure_ task:
    say 1013
    end quest

variable _entlibr_

_givebook_ task:
    when _entlibr_ and _success_
    give pc _reward_
    end quest

_timer_ task:
    end quest